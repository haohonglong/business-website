; (function ($) { var FadeSlide = function (carousel) { var self = this; this.carousel = carousel; this.setting = { "pictures": ".banner li", "indexs": ".bannerindex dd", "btnPrev": ".prev", "btnNext": ".next", "infos": ".title p", "autoPlay": true, "delay": 5000 }; $.extend(this.setting, this.getSetting()); this.itemPics = carousel.find(this.setting.pictures); this.itemIndexs = carousel.find(this.setting.indexs); this.itemInfos = carousel.find(this.setting.infos); this.prevBtn = carousel.find(this.setting.btnPrev); this.nextBtn = carousel.find(this.setting.btnNext); this.picLens = this.itemPics.length; this.delay = this.setting.delay; this.timer = 0; this.cIndex = 0; this.pIndex = -1; this.cItemPic = this.itemPics.eq(this.cIndex); this.cItemIndex = this.itemIndexs.eq(this.cIndex); this.setDefault(); if (this.picLens > 1) { this.goFade() } this.prevBtn.click(function () { self.goFade(self.indexReduce()) }); this.nextBtn.click(function () { self.goFade(self.indexAdd()) }); this.itemIndexs.hover(function () { self.cIndex = $(this).index(); if (self.cIndex === self.pIndex) return; self.goFade(self.cIndex) }); this.carousel.hover(function () { clearTimeout(self.timer) }, function () { self.autoPlay() }) }; FadeSlide.prototype = { autoPlay: function () { var self = this; this.timer = setTimeout(function () { self.goFade(self.indexAdd()) }, this.delay) }, goFade: function (cIndex) { clearTimeout(this.timer); this.pIndex = this.cIndex; this.cItemPic.stop(false, true).fadeOut(800); this.cItemPic = this.itemPics.eq(this.cIndex).stop(false, true).fadeIn(800); this.cItemIndex.removeClass("on"); this.cItemIndex = this.itemIndexs.eq(this.cIndex).addClass("on"); this.itemInfos.hide(); this.itemInfos.eq(this.cIndex).fadeIn(400); if (this.picLens > 1) { this.autoPlay() } }, setDefault: function () { this.itemPics.first().show(); if (this.itemIndexs.length == 1) { this.cItemIndex.hide(); this.prevBtn.hide(); this.nextBtn.hide() } }, indexAdd: function () { return (this.cIndex === this.picLens - 1) ? this.cIndex = 0 : ++this.cIndex }, indexReduce: function () { return (this.cIndex === 0) ? this.cIndex = this.picLens - 1 : --this.cIndex }, getSetting: function () { var setting = this.carousel.attr("data-setting"); if (setting && setting != "") { return $.parseJSON(setting) } else { return {} } } }; FadeSlide.init = function (dom) { var _this_ = this; dom.each(function () { new _this_($(this)) }) }; window["FadeSlide"] = FadeSlide })(jQuery);